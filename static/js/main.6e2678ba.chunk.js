(this.webpackJsonpbudget=this.webpackJsonpbudget||[]).push([[0],{16:function(e){e.exports=JSON.parse('{"base_url":"http://localhost:9000/api/"}')},44:function(e,t,a){},45:function(e,t,a){},72:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(37),s=a.n(r),i=(a(44),a(45),a(13)),l=a(5),u=a(7),o=a(8),d=a(17),b=a(1),j=Object(n.memo)((function(e){var t=e.index,a=e.selected,c=void 0!==a&&a,r=e.onSelect,s=void 0===r?function(e){return e}:r,i=Object(n.useCallback)((function(){return s(t+1)}),[t,s]);return Object(b.jsx)(d.c,{color:c?"yellow":"grey",className:"inline-block",onClick:i})}));function O(e){var t=e.totalStars,a=void 0===t?5:t,c=e.selectedStars,r=void 0===c?0:c,s=e.onRate,i=Object(n.useMemo)((function(){return Object(o.a)(new Array(a))}),[a]);return Object(b.jsxs)(b.Fragment,{children:[i.map((function(e,t){return Object(b.jsx)(j,{index:t,selected:r>t,onSelect:s},t)})),Object(b.jsxs)("p",{className:"text-xs text-gray-700",children:[r," of ",a," stars"]})]})}var p=a(2),h=a.n(p),x=a(3),f=a(4),m=a(15),v=a.n(m),y=a(16),g=Object(n.createContext)(),w=function(){return Object(n.useContext)(g)},C=function(e){var t=e.children,a=Object(n.useState)(!1),c=Object(f.a)(a,2),r=c[0],s=c[1],i=Object(n.useState)({}),l=Object(f.a)(i,2),o=l[0],d=l[1],j=Object(n.useState)(),O=Object(f.a)(j,2),p=O[0],m=O[1],w=Object(n.useState)(!1),C=Object(f.a)(w,2),N=C[0],k=C[1],S=Object(n.useState)([]),_=Object(f.a)(S,2),T=_[0],P=_[1],F=Object(n.useCallback)(Object(x.a)(h.a.mark((function e(){var t,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,m(),k(!0),e.next=5,v.a.get("".concat(y.base_url,"places"));case 5:return t=e.sent,a=t.data,P(a.data),e.abrupt("return",a.data);case 11:e.prev=11,e.t0=e.catch(0),m(e.t0);case 14:return e.prev=14,k(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,11,14,17]])}))),[]);Object(n.useEffect)((function(){r||(F(),s(!0))}),[r,F]);var q=Object(n.useCallback)(function(){var e=Object(x.a)(h.a.mark((function e(t){var a,n,c,r,s,i,l,u;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id,n=t.name,c=t.rating,m(),k(!0),r={name:n,rating:c},s=a?"put":"post",i="".concat(y.base_url,"places/").concat(null!==a&&void 0!==a?a:""),e.prev=6,e.next=9,v()({method:s,url:i,data:r});case 9:return l=e.sent,u=l.changedPlace,e.next=13,F();case 13:return e.abrupt("return",u);case 16:throw e.prev=16,e.t0=e.catch(6),console.error(e.t0),e.t0;case 20:return e.prev=20,k(!1),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[6,16,20,23]])})));return function(t){return e.apply(this,arguments)}}(),[F]),D=Object(n.useCallback)(function(){var e=Object(x.a)(h.a.mark((function e(t,a){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=T.find((function(e){return e.id===t})),e.next=3,q(Object(u.a)(Object(u.a)({},n),{},{rating:a}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),[T,q]),U=Object(n.useCallback)(function(){var e=Object(x.a)(h.a.mark((function e(t){var a,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(!0),m(),e.prev=2,e.next=5,v()({method:"delete",url:"".concat(y.base_url,"places/").concat(t)});case 5:return a=e.sent,n=a.data,F(),e.abrupt("return",n);case 11:throw e.prev=11,e.t0=e.catch(2),console.error(e.t0),e.t0;case 15:return e.prev=15,k(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[2,11,15,18]])})));return function(t){return e.apply(this,arguments)}}(),[F]),L=Object(n.useMemo)((function(){return{currentPlace:o,setCurrentPlace:d,places:T,error:p,loading:N,ratePlace:D,deletePlace:U,createOrUpdatePlace:q}}),[T,p,N,d,D,U,o,q]);return Object(b.jsx)(g.Provider,{value:L,children:t})},N=Object(n.memo)((function(e){var t=e.id,a=e.name,c=e.rating,r=w().ratePlace,s=Object(n.useCallback)((function(e){r(t,e)}),[r,t]);return Object(b.jsxs)("div",{"data-cy":"place",className:"bg-white px-4 py-5 border-2 border-gray-400 rounded m-2 text-center",children:[Object(b.jsx)("h2",{className:"mt-2 mb-2 font-bold",children:a}),Object(b.jsx)(O,{selectedStars:c,onRate:s})]})}));function k(e){var t=e.places;return Object(b.jsx)("div",{className:"flex flex-wrap",children:t.sort((function(e,t){return e.name.toUpperCase().localeCompare(t.name.toUpperCase())})).map((function(e){return Object(b.jsx)(N,Object(u.a)({},e),e.id)}))})}function S(){var e=w().places;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h1",{children:"Places"}),Object(b.jsx)(k,{places:e})]})}var _=Object(n.createContext)(),T=function(e){var t=e.children,a=Object(n.useState)(!1),c=Object(f.a)(a,2),r=c[0],s=c[1],i=Object(n.useState)([]),l=Object(f.a)(i,2),u=l[0],o=l[1],d=Object(n.useState)(),j=Object(f.a)(d,2),O=j[0],p=j[1],m=Object(n.useState)(!1),g=Object(f.a)(m,2),w=g[0],C=g[1],N=Object(n.useState)({}),k=Object(f.a)(N,2),S=k[0],T=k[1],P=Object(n.useCallback)(Object(x.a)(h.a.mark((function e(){var t,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,p(),C(!0),e.next=5,v.a.get("".concat(y.base_url,"transactions?limit=25&offset=0"));case 5:t=e.sent,a=t.data,o(a.data),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),p(e.t0);case 13:return e.prev=13,C(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[0,10,13,16]])}))),[]);Object(n.useEffect)((function(){r||(P(),s(!0))}),[r,P]);var F=Object(n.useCallback)(function(){var e=Object(x.a)(h.a.mark((function e(t){var a,n,c,r,s,i,l,u,o,d;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id,n=t.placeId,c=t.amount,r=t.date,s=t.user,p(),C(!0),i={placeId:n,amount:c,date:r,user:s},l=a?"put":"post",u="".concat(y.base_url,"transactions/").concat(null!==a&&void 0!==a?a:""),e.prev=6,e.next=9,v()({method:l,url:u,data:i});case 9:return o=e.sent,d=o.changedTransaction,e.next=13,P();case 13:return e.abrupt("return",d);case 16:throw e.prev=16,e.t0=e.catch(6),console.log(e.t0),e.t0;case 20:return e.prev=20,C(!1),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[6,16,20,23]])})));return function(t){return e.apply(this,arguments)}}(),[P]),q=Object(n.useCallback)(function(){var e=Object(x.a)(h.a.mark((function e(t){var a,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,p(),C(!0),e.next=5,v()({method:"delete",url:"".concat(y.base_url,"transactions/").concat(t)});case 5:return a=e.sent,n=a.data,P(),e.abrupt("return",n);case 11:throw e.prev=11,e.t0=e.catch(0),console.log(e.t0),e.t0;case 15:return e.prev=15,C(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,11,15,18]])})));return function(t){return e.apply(this,arguments)}}(),[P]),D=Object(n.useCallback)((function(e){T(null===e?{}:u.find((function(t){return t.id===e})))}),[u]),U=Object(n.useMemo)((function(){return{transactions:u,error:O,loading:w,currentTransaction:S,createOrUpdateTransaction:F,deleteTransaction:q,setTransactionToUpdate:D}}),[u,O,w,S,F,q,D]);return Object(b.jsx)(_.Provider,{value:U,children:t})},P=a(18),F=a(23),q=["label","type","defaultValue","validation"],D=function(e){var t=e.label,a=e.type,n=e.defaultValue,c=e.validation,r=Object(F.a)(e,q),s=Object(P.c)(),i=s.register,l=s.formState.errors;return Object(b.jsxs)("div",{className:"col-span-6 sm:col-span-3",children:[Object(b.jsx)("label",{htmlFor:t,children:t}),Object(b.jsx)("input",Object(u.a)(Object(u.a)({},i(t,c)),{},{defaultValue:n,placeholder:t,type:a,id:t,name:t},r)),l[t]&&Object(b.jsx)("p",{"data-cy":"labelinput-error",className:"text-red-500",children:l[t].message})]})},U=["label","options","validation"],L=function(e){var t=e.label,a=e.options,n=e.validation,c=Object(F.a)(e,U),r=Object(P.c)(),s=r.register,i=r.formState.errors;return Object(b.jsxs)("div",{className:"col-span-6 sm:col-span-3",children:[Object(b.jsx)("label",{htmlFor:t,children:t}),Object(b.jsxs)("select",Object(u.a)(Object(u.a)(Object(u.a)({},s(t,n)),c),{},{id:t,name:t,children:[Object(b.jsxs)("option",{value:"",children:["--choose a ",t,"--"]}),a.map((function(e){return Object(b.jsx)("option",{value:e.id,children:e.name},e.id)}))]})),i[t]&&Object(b.jsx)("p",{className:"text-red-500",children:i[t].message})]})},V={user:{required:"this is required",minLength:{value:2,message:"Min length is 2"}},date:{required:"this is required"},place:{required:"this is required"},amount:{valueAsNumber:!0,required:"this is required",min:{value:1,message:"min 1"},max:{value:5e3,message:"max 5000"}}},E=function(e){if(!e)return null;typeof e!==Object&&(e=new Date(e));var t=e.toISOString();return t.substring(0,t.indexOf("T"))};function I(){var e=Object(l.h)().id,t=Object(l.g)(),a=Object(P.b)(),c=a.handleSubmit,r=a.reset,s=a.setValue,o=Object(n.useContext)(_),d=o.currentTransaction,j=o.setTransactionToUpdate,O=o.createOrUpdateTransaction,p=Object(n.useContext)(g).places;Object(n.useEffect)((function(){if(!d||0===Object.keys(d).length&&d.constructor===Object)r();else{var e=E(new Date(d.date));s("date",e),s("user",d.user.name),s("place",d.place.id),s("amount",d.amount)}}),[d,s,r]),Object(n.useEffect)((function(){console.log("id",e),j(e)}),[e,j]);var f=Object(n.useCallback)(function(){var e=Object(x.a)(h.a.mark((function e(a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O({id:null===d||void 0===d?void 0:d.id,placeId:a.place,amount:a.amount,date:new Date(a.date),user:a.user});case 3:j(null),t.push("/transactions"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),[O,null===d||void 0===d?void 0:d.id,j,t]);return Object(b.jsx)(P.a,Object(u.a)(Object(u.a)({},a),{},{children:Object(b.jsx)("form",{onSubmit:c(f),className:"m-5",children:Object(b.jsxs)("div",{className:"grid grid-cols-6 gap-6",children:[Object(b.jsx)(D,{label:"user",type:"text",defaultValue:"",validation:V.user,"data-cy":"user_input"}),Object(b.jsx)(D,{label:"date",type:"date",defaultValue:E(new Date),validation:V.date,"data-cy":"date_input"}),Object(b.jsx)(L,{label:"place",options:p,validation:V.place,"data-cy":"place_input"}),Object(b.jsx)(D,{label:"amount",type:"number",defaultValue:"0",validation:V.amount,"data-cy":"amount_input"}),Object(b.jsx)("div",{className:"col-span-12 sm:col-span-6",children:Object(b.jsxs)("div",{className:"flex justify-end",children:[Object(b.jsx)("button",{type:"submit","data-cy":"submit_transaction",children:(null===d||void 0===d?void 0:d.id)?"Save transaction":"Add transaction"}),Object(b.jsx)(i.b,{className:"button",to:"/transactions",children:"Cancel"})]})})]})})}))}var M=Object(n.memo)((function(e){var t=e.id,a=e.date,c=e.amount,r=e.user,s=e.place,l=Object(n.useContext)(_).deleteTransaction,u=Object(n.useCallback)((function(){l(t)}),[l,t]);return Object(b.jsxs)("tr",{"data-cy":"transaction",children:[Object(b.jsx)("td",{"data-cy":"transaction_date",className:"border w-1/4 px-4 py-2",children:new Date(a).toLocaleDateString("nl-BE",{day:"2-digit",month:"2-digit",year:"numeric"})}),Object(b.jsx)("td",{"data-cy":"transaction_user",className:"border w-1/4 px-4 py-2",children:r.name}),Object(b.jsx)("td",{"data-cy":"transaction_place",className:"border w-1/4 px-4 py-2",children:s.name}),Object(b.jsxs)("td",{"data-cy":"transaction_amount",className:"border w-1/4 px-4 py-2",children:[c," \u20ac"]}),Object(b.jsx)("td",{className:"border w-1/4 px-4 py-2",children:Object(b.jsxs)("div",{className:"flex flex-row space-x-2",children:[Object(b.jsx)(i.b,{className:"button","data-cy":"transaction_edit_btn",to:"/transactions/edit/".concat(t),children:Object(b.jsx)(d.b,{})}),Object(b.jsx)("button",{"data-cy":"transaction_remove_btn",onClick:u,children:Object(b.jsx)(d.d,{})})]})})]})}));function A(e){var t=e.search,a=Object(n.useContext)(_),c=a.transactions,r=a.error,s=a.loading,l=Object(n.useMemo)((function(){return c.filter((function(e){return e.place.name.toLowerCase().includes(t.toLowerCase())}))}),[c,t]);return s?Object(b.jsx)("h1",{"data-cy":"loading",children:"Loading..."}):r?Object(b.jsx)("p",{"data-cy":"transactions_error",className:"error",children:JSON.stringify(r,null,2)}):c&&c.length?Object(b.jsxs)("table",{className:"table-fixed m-auto",children:[Object(b.jsx)("thead",{children:Object(b.jsxs)("tr",{children:[Object(b.jsx)("th",{children:"Date"}),Object(b.jsx)("th",{children:"User"}),Object(b.jsx)("th",{children:"What?"}),Object(b.jsx)("th",{children:"Amount"}),Object(b.jsx)("th",{})]})}),Object(b.jsx)("tbody",{children:l.map((function(e){return Object(b.jsx)(M,Object(u.a)({},e),e.id)}))})]}):Object(b.jsxs)("p",{className:"info flex flex-row items-center",children:[Object(b.jsx)("span",{className:"flex-1",children:"There are no transactions"}),Object(b.jsx)(i.b,{to:"add",className:"button",children:"Create one"})]})}function J(){var e=Object(n.useState)(""),t=Object(f.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)(""),s=Object(f.a)(r,2),l=s[0],u=s[1],o=Object(n.useCallback)((function(e){return c(e.target.value)}),[]),j=Object(n.useCallback)((function(){return u(a)}),[a]);return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h1",{children:"Transactions"}),Object(b.jsxs)("div",{className:"flex my-4",children:[Object(b.jsx)("input",{"data-cy":"transactions_search_input",type:"search",value:a,onChange:o,className:"flex-1",placeholder:"Search for a transaction"}),Object(b.jsx)("button",{type:"button","data-cy":"transactions_search_btn",onClick:j,children:"Search"})]}),Object(b.jsx)("div",{className:"flex justify-end my-2",children:Object(b.jsxs)(i.b,{className:"button flex flex-row items-center",to:"/transactions/add",children:[Object(b.jsx)(d.a,{})," New transaction"]})}),Object(b.jsx)(A,{search:l})]})}var B=function(){return Object(b.jsx)(C,{children:Object(b.jsx)(T,{children:Object(b.jsx)(i.a,{children:Object(b.jsxs)(l.d,{children:[Object(b.jsx)(l.b,{path:"/",exact:!0,children:Object(b.jsx)(l.a,{to:"/transactions"})}),Object(b.jsx)(l.b,{path:"/transactions",exact:!0,children:Object(b.jsx)(J,{})}),Object(b.jsx)(l.b,{path:"/transactions/add",exact:!0,children:Object(b.jsx)(I,{})}),Object(b.jsx)(l.b,{path:"/transactions/edit/:id",exact:!0,children:Object(b.jsx)(I,{})}),Object(b.jsx)(l.b,{path:"/places",children:Object(b.jsx)(S,{})})]})})})})},R=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,73)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;a(e),n(e),c(e),r(e),s(e)}))};s.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(B,{})}),document.getElementById("root")),R()}},[[72,1,2]]]);
//# sourceMappingURL=main.6e2678ba.chunk.js.map